<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The African Jewelry Shop -- Add Item</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body id="admin-add-body">

<header class="admin-catalog-header">

    <button id="admin-menu-toggle"
            class="admin-menu-button"
            type="button"
            aria-label="Open admin menu">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <div class="admin-title-block">
        <h1>THE AFRICAN JEWELRY SHOP</h1>
        <h2>ADMIN</h2>
    </div>

    <div style="width:26px;"></div>
</header>

<main class="admin-add-main">
    <section class="admin-add-left">
        <h1 class="admin-add-title">ADD ITEM</h1>

        <p class="admin-add-subtitle">
            Provide the item's name, price, and image to
            sell to customers
        </p>

        <!-- Success notification -->
        <div th:if="${itemAdded}" id="item-added-toast" class="cart-toast" style="display: block;">
            <span th:text="${itemName != null ? itemName + ' added' : 'Item added'}">Item added</span>
        </div>

        <!-- Error message -->
        <div th:if="${error}" class="error-message" style="color: red; margin-bottom: 1rem;">
            <span th:text="${error}">Error message</span>
        </div>

        <form class="admin-add-form"
              th:action="@{/admin/add-item}"
              method="post"
              enctype="multipart/form-data"
              id="add-item-form">

            <input class="admin-add-input"
                   type="text"
                   name="name"
                   id="item-name"
                   placeholder="Name"
                   required>

            <input class="admin-add-input"
                   type="text"
                   name="price"
                   id="item-price"
                   placeholder="Price $"
                   pattern="[0-9]+(\.[0-9]{1,2})?"
                   title="Please enter a valid number (e.g., 100 or 99.99)"
                   required>

            <p class="admin-add-upload-label">Upload Image</p>

            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                <input id="admin-add-image"
                       class="admin-add-file-input"
                       type="file"
                       name="imageFile"
                       accept="image/*"
                       required
                       onchange="previewImage(this)">

                <label for="admin-add-image"
                       class="admin-add-upload-box">
                    <span class="admin-add-upload-icon">â¬†</span>
                </label>

                <!-- Image preview -->
                <img id="image-preview" 
                     src="" 
                     alt="Preview" 
                     style="max-width: 150px; max-height: 150px; display: none; border: 1px solid #ccc; border-radius: 4px;">
            </div>

            <button type="submit"
                    class="admin-add-submit">
                ADD ITEM
            </button>
        </form>

        <script>
            function previewImage(input) {
                const preview = document.getElementById('image-preview');
                if (input.files && input.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.src = e.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(input.files[0]);
                } else {
                    preview.style.display = 'none';
                }
            }

            // Clear form after successful submission
            document.addEventListener('DOMContentLoaded', function() {
                const form = document.getElementById('add-item-form');
                const itemAdded = /*[[${itemAdded}]]*/ false;
                
                if (itemAdded) {
                    // Clear form fields
                    document.getElementById('item-name').value = '';
                    document.getElementById('item-price').value = '';
                    document.getElementById('admin-add-image').value = '';
                    document.getElementById('image-preview').style.display = 'none';
                    document.getElementById('image-preview').src = '';
                    
                    // Hide toast after 3 seconds
                    setTimeout(function() {
                        const toast = document.getElementById('item-added-toast');
                        if (toast) {
                            toast.style.display = 'none';
                        }
                    }, 3000);
                }
            });
        </script>
    </section>

    <aside class="admin-add-right">
        <img class="admin-add-hero"
             th:src="@{/images/african-man.png}"
             src="/images/african-man.png"
             alt="Man wearing layered gold jewelry">
    </aside>
</main>

<!-- Side overlay menu (same behavior as admin catalog, order matches screenshot) -->
<div id="admin-menu-overlay" class="admin-menu-overlay">
    <div class="admin-menu-panel">
        <nav class="admin-menu-nav">
            <a th:href="@{/add-item}" href="/add-item">ADD ITEM</a>
            <a th:href="@{/admin-catalog}" href="/admin-catalog">CATALOG</a>
            <a th:href="@{/search}" href="/search">SEARCH</a>
            <a th:href="@{/sales-report}" href="/sales-report">SALES REPORT</a>
            <a th:href="@{/promote-user}" href="/promote-user">PROMOTE USER</a>
        </nav>
    </div>
</div>

<script th:src="@{/js/app.js}"></script>
</body>
</html>
